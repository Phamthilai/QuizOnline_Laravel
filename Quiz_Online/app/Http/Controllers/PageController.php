<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\Auth;
use App\News;
use DB;
use App\Areas;
use App\Partners;
use App\User;
use App\IdCode;
class PageController extends Controller
{
    public function getNews(){
    	$news = News::all();
    	return view('layouts.front-end.news',compact('news'));
    }
    public function getNews_detail($id){
        $newsdetail = News::find($id);
        $newsdetail = DB::table('news')->select('title','brief','image')->get();
        return view('layouts.front-end.news_detail',compact('newsdetail'));
    }

    public function getPartners($id){
    	$partner = Partners::find($id);
    	$partner = Partners::where('id_areas',$id)->paginate(10);
    	$p = Partners::all();
    	return view('layouts.front-end.partner', compact('partner','p'));  	
    }















































































































































































































































































//quyen

    public function postIdCode(Request $req){
       $this->validate($req,
           [
                'id_code' => 'required|min:3|max:32'
           ],
           [
                'id_code.required' =>'Bạn chưa nhập id_code',
                'id_code.min' => 'id_code không được nhỏ hơn 3 ký tự',
                'id_code.max' => 'id_code không được lớn hơn 32 ký tự'
           ]
       );
       $credentials = array('id_code'=>$req->id_code);
       $idcode = IdCode::select('id_code')->get();
       foreach($idcode as $val){
        if($val['id_code']==$req->id_code){
            return redirect()->route('register')->with(['flag'=>'success','message'=>'Đăng nhập thành công']);
           }
           else{
               return redirect()->back()->with(['flag'=>'danger','message'=>'Đăng nhập không thành công']);
           }
        }
   }
}













































































































































































































































































//Quyen
